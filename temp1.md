## 1.  transfer 和 send 之间有什么区别？为什么不应该使用它们？

**`transfer` 和 `send` 有固定的 2300 gas 限制，限制了复杂合约的灵活性，不推荐使用。`call` 更灵活，更适合现代开发。**

---

## 2. 如何在 Solidity 中编写高效的 gas 循环？

**优化 Solidity 循环的关键在于减少存储操作、使用 `memory` 代替 `storage`、限制迭代次数等，以降低 gas 消耗。**

---

## 3. 代理合约中的存储冲突是什么？

**代理合约中的存储冲突是指代理合约和实现合约共享同一存储槽，导致数据覆盖或不一致问题。**

---

## 4. 什么是闪电贷？

**闪电贷是一种允许用户在同一笔交易内借款并归还资金的贷款，因其利用区块链的原子性而无需抵押。**

---

## 5. 在权益证明之前后，block.timestamp 发生了什么变化？

**在权益证明（PoS）中，`block.timestamp` 变得更加可靠和确定，因为 PoS 系统采用固定时隙机制，验证者无法操控时间戳。**

---

## 6. 什么是抢跑（frontrunning）？

**抢跑（Frontrunning）是区块链中的行为，攻击者监视未确认交易，提交优先交易获取利益。**

---

## 7. 什么是提交-揭示方案，何时使用它？

**提交-揭示方案分为提交和揭示两阶段，确保公平性、隐私性、防操控。**

---

## 8. 在什么情况下，abi.encodePacked 可能会产生漏洞？

**`abi.encodePacked` 在处理动态类型时可能导致哈希碰撞，需小心使用。**

---

## 9. 以太坊如何确定 EIP-1559[10] 中的 BASEFEE？

**`BASEFEE` 是 EIP-1559 中引入的动态交易费用，会根据区块的 gas 使用量自动调整。**

---

## 10. 冷读（cold read）和热读（warm read）之间有什么区别？

**冷读（Cold Read）从未缓存的数据中读取，消耗较高 Gas；热读（Warm Read）从缓存中读取，消耗较少 Gas。**

---

## 11. AMM 如何定价资产？

**AMM 通过数学公式（如恒定乘积公式）根据流动性池中资产的比例动态调整价格。**

---

## 12. 代理中的函数选择器冲突是什么，它是如何发生的？

**代理合约和实现合约之间共享函数选择器空间，导致同一选择器调用时可能执行错误的逻辑。**

---

## 13. 什么是签名重放攻击？

**签名重放攻击通过重发已签名的合法交易来重复执行，导致资金损失或未授权操作。**

---

## 14. 什么是 gas griefing(恶意破坏) ？

**Gas Griefing（恶意 Gas 破坏）是一种攻击方式，攻击者通过增加交易或合约操作的 gas 消耗，导致受害者承担高额费用或交易失败。**

---

## 15. 如何设计一个石头-剪刀-布的智能合约游戏，使玩家无法作弊？

**通过**提交-揭示方案**防止玩家在石头-剪刀-布智能合约游戏中作弊，确保游戏的公平性。**

---

## 16. 自由内存指针是什么，它存储在哪里？

**自由内存指针（Free Memory Pointer）是指向堆上下一块可用内存区域的指针，帮助 Solidity 合约管理动态内存分配。它存储在内存的地址 `0x40`**

---

## 17. 接口中有效的函数修饰符有哪些？

**在 Solidity 接口中，唯一有效的函数修饰符是 `external`，因为接口只定义函数的签名，不能包含具体实现。**

---

## 18. 函数参数中的 memory 和 calldata 有什么区别？

**`memory` 和 `calldata` 是 Solidity 中的两种数据存储位置。`memory` 是可修改的临时存储，而 `calldata` 是只读的外部输入数据存储，使用 `calldata` 可以节省 Gas。**

---

## 19. 描述三种存储 gas 成本类型。

**存储操作的 Gas 成本取决于是否写入新值、修改已有值或清除存储槽。**

---

## 20. 为什么可升级合约不应该使用构造函数？

**在可升级合约中，构造函数无法正常执行或初始化代理合约的状态变量，因此应使用初始化函数代替构造函数。**

---

## 21. UUPS 和 Transparent Upgradeable Proxy 模式之间有什么区别？

**UUPS 和 Transparent Upgradeable Proxy 模式的区别在于升级逻辑的位置。UUPS 模式将升级逻辑放在实现合约中，而 Transparent 模式将其放在代理合约中，导致它们在复杂性和 Gas 成本上有所不同。**

---

## 22. 如果合约通过 delegatecall 调用一个空地址或之前已自毁的实现，会发生什么？如果是常规调用而不是 delegatecall 呢？

**如果合约通过 `delegatecall` 调用空地址或已自毁的合约，调用会失败且返回 `false`，但不会自动回滚。常规调用则可能触发异常，自动回滚交易。**

---

## 23. ERC777 代币存在什么危险？

**ERC777 代币引入的钩子和操作员机制等功能带来灵活性的同时，也引发了重入攻击等安全风险。**

---

## 24. 什么是债券曲线(bonding curve)？

**债券曲线是一种通过数学公式动态调整资产价格与供应量关系的机制，常用于去中心化金融中的自动定价和流动性管理。**

---

## 25. OpenZeppelin ERC721 实现中的 safeMint 与 mint 有何不同？

**`safeMint` 确保接收方（特别是智能合约）能够正确处理 ERC721 代币，而 `mint` 则不会进行此类检查，可能导致代币被锁定在无法处理的智能合约中。**

---

## 26. 什么是三明治(sandwich)攻击？

**三明治攻击通过前置和后置交易夹击目标交易，从市场波动中获利。**

---

## 27. 如果向一个会回滚的函数进行 delegatecall，delegatecall 会怎么做？

**`delegatecall` 返回布尔值以指示目标函数执行是否成功，而不会自动回滚调用者合约的状态。**

---

## 28. 乘以和除以二的倍数的 gas 高效替代方法是什么？

**乘以或除以 2 的倍数时，使用位移运算可以显著节省 Gas。**

---

## 29. 多大 uint 可以与一个地址在一个槽中？

**一个 `address`（160 位）可以与总位数不超过 96 位的 `uint` 变量组合存储在一个 256 位的槽中，节省存储空间和 Gas。**

---

## 30. 哪些操作会部分退还 gas？

**清除存储槽和销毁合约可以触发部分 Gas 退款，主要为了鼓励减少区块链存储负担。**

---

## 31. ERC165 作用于什么？

**ERC165 是一种用于检测智能合约是否支持某个接口的标准机制，确保合约交互的兼容性和安全性。**

---

## 32. 如果代理对 A 进行 delegatecall，而 A 执行 address(this).balance，返回的是代理的余额还是 A 的余额？

**当代理通过 `delegatecall` 调用合约 A 并执行 `address(this).balance` 时，返回的是代理合约的余额，而不是合约 A 的余额。**

---

## 33. 滑点参数有什么用？

**滑点参数用于控制交易中的价格波动，保护用户免受因市场波动导致的预期外损失。**

---

## 34. ERC721A 如何减少铸造成本？有什么权衡？

**ERC721A 通过减少存储操作和优化批量铸造来降低 Gas 成本，但会带来所有权管理的复杂性。**

---

## 35. 什么是 TWAP？

**TWAP（Time-Weighted Average Price）是基于时间的加权平均价格，旨在减少市场波动对价格的影响，提供更稳定的价格参考。**

---

## 36. Compound Finance 如何计算利用率？

**利用率衡量借贷市场的资金使用情况，表示已借出资金占总可借资金的比例，反映市场的供需动态。**

---

## 37. 为什么大量合约字节码以 6080604052 开头？这个字节码序列是做什么的？

**`6080604052` 是合约部署时的初始化代码，负责分配内存并设置运行环境。**

---

## 38. 内存中的 bytes 和 bytes1[] 之间有什么区别？

**`bytes` 是紧凑存储的动态字节数组，`bytes1[]` 是动态数组，存储开销更大。**

---

## 39. 以太坊预编译合约的地址是什么？

**以太坊的预编译合约是执行复杂计算的高效合约，映射到固定地址，从 `0x01` 到 `0x09`，提供加密、哈希等常用功能。**

---

## 40. uint64 和 uint256 在 calldata 中的 ABI 编码有何不同？

**`uint64` 和 `uint256` 在 ABI 编码中的主要区别在于 `uint64` 需要填充高位以对齐到 32 字节，而 `uint256` 已经是 32 字节，无需填充。**

---

## 41. 为什么 calldata 中的负数会消耗更多的 gas？

**负数在 EVM 中以补码表示，包含更多非零字节，导致 `calldata` 加载时消耗更多 gas。**

---